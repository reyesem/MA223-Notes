"0","plot.dat <- data_frame("
"0","  x = seq(-5, 5, length.out = 1000),"
"0","  mu = mean(subset(babies.df$Weight, babies.df$Tobacco==""Yes"")) - "
"0","    mean(subset(babies.df$Weight, babies.df$Tobacco==""No"")),"
"0","  sd = sqrt(var(subset(babies.df$Weight, babies.df$Tobacco==""Yes""))/sum(babies.df$Tobacco==""Yes"") +"
"0","              var(subset(babies.df$Weight, babies.df$Tobacco==""No""))/sum(babies.df$Tobacco==""No"")),"
"0","  d = x*sd + mu,"
"0","  y = dt(x, df = nrow(babies.df) - 1)*(1/sd),"
"0","  group = (d<=ci[2] & d>=ci[1])"
"0",")"
"0","ggplot(data = plot.dat,"
"0","       mapping = aes(x = d, y = y, fill = group)) +"
"0","  geom_area(color = ""black"", size = 1.1) +"
"0","  labs(x = ""Sample Mean Difference in Birthweight (Tobacco Use - No Tobacco Use)"") +"
"0","  scale_fill_manual(values = c(""TRUE"" = ""red"", ""FALSE"" = ""grey75"")) +"
"0","  geom_vline(data = data_frame(xintercept = ci),"
"0","             mapping = aes(xintercept = xintercept),"
"0","             colour = ""red"", linetype = 2, size = 1.1) +"
"0","  annotate(""label"", x = ci[1], y = 0.004, label = round(ci[1], 2), colour = ""red"") +"
"0","  annotate(""label"", x = ci[2], y = 0.004, label = round(ci[2], 2), colour = ""red"") +"
"0","  guides(fill = ""none"") +"
"0","  theme_bw(12) +"
"0","  theme(axis.text.y = element_blank(),"
"0","        axis.title.y = element_blank(),"
"0","        axis.ticks.y = element_blank())"
